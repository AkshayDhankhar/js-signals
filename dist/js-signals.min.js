/*
 * JS Signals <https://github.com/millermedeiros/js-signals>
 * Released under the MIT license (http://www.opensource.org/licenses/mit-license.php)
 * @author Miller Medeiros <http://millermedeiros.com>
 * @version 0.4
 * @build 64 11/27/2010 04:19 PM
 */
(function(){var n=window.signals={};n.Signal=function(){this._bindings=[]};n.Signal.prototype={_shouldPropagate:true,_isEnabled:true,_registerListener:function f(x,w,v){var u=this._indexOfListener(x),y;if(u!==-1){y=this._bindings[u];if(y.isOnce()!==w){throw new Error("You cannot "+(w?"add()":"addOnce()")+" then "+(!w?"add()":"addOnce()")+" the same listener without removing the relationship first.")}}else{y=new n.SignalBinding(x,w,v,this);this._addBinding(y)}return y},_addBinding:function c(u){this._bindings.push(u)},_indexOfListener:function i(u){var v=this._bindings.length;while(v--){if(this._bindings[v].listener===u){return v}}return -1},add:function j(v,u){return this._registerListener(v,false,u)},addOnce:function m(v,u){return this._registerListener(v,true,u)},remove:function t(v){var u=this._indexOfListener(v);if(u!==-1){this._bindings.splice(u,1)}return v},removeAll:function a(){this._bindings.length=0},getNumListeners:function k(){return this._bindings.length},disable:function b(){this._isEnabled=false},enable:function h(){this._isEnabled=true},isEnabled:function o(){return this._isEnabled},halt:function g(){this._shouldPropagate=false},dispatch:function s(x){if(!this._isEnabled){return}var u=Array.prototype.slice.call(arguments),y=this._bindings.slice(),v=0,w;this._shouldPropagate=true;while(w=y[v++]){if(w.execute(u)===false||!this._shouldPropagate){break}}},toString:function l(){return"[Signal isEnabled: "+this._isEnabled+" numListeners: "+this.getNumListeners()+"]"}};n.SignalBinding=function e(x,v,u,w){this.listener=x;this._isOnce=v;this.listenerScope=u;this._signal=w};n.SignalBinding.prototype={_isEnabled:true,execute:function d(u){if(this._isEnabled){if(this._isOnce){this.detach()}return this.listener.apply(this.listenerScope,u)}},detach:function q(){return this._signal.remove(this.listener)},dispose:function p(){this.detach();delete this._signal;delete this.listener;delete this.listenerScope},disable:function b(){this._isEnabled=false},enable:function h(){this._isEnabled=true},isEnabled:function o(){return this._isEnabled},isOnce:function r(){return this._isOnce},toString:function l(){return"[SignalBinding listener: "+this.listener+", isOnce: "+this._isOnce+", isEnabled: "+this._isEnabled+", listenerScope: "+this.listenerScope+"]"}}}());