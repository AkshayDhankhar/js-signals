/*!
 * JS Signals <https://github.com/millermedeiros/js-signals>
 * Released under the MIT license (http://www.opensource.org/licenses/mit-license.php)
 * @author Miller Medeiros <http://millermedeiros.com>
 * @version 0.5
 * @build 100 12/03/2010 05:27 PM
 */
(function(){var a=window.signals={};a.VERSION="0.5";a.isDef=function(b){return typeof b!=="undefined"};a.Signal=function(){this._bindings=[]};a.Signal.prototype={_shouldPropagate:true,_isEnabled:true,_registerListener:function(e,d,c){if(!a.isDef(e)){throw new Error("listener is a required param of add() and addOnce().")}var b=this._indexOfListener(e),f;if(b!==-1){f=this._bindings[b];if(f.isOnce()!==d){throw new Error("You cannot add"+(d?"":"Once")+"() then add"+(!d?"":"Once")+"() the same listener without removing the relationship first.")}}else{f=new a.SignalBinding(e,d,c,this);this._addBinding(f)}return f},_addBinding:function(b){this._bindings.push(b)},_indexOfListener:function(b){var c=this._bindings.length;while(c--){if(this._bindings[c]._listener===b){return c}}return -1},add:function(c,b){return this._registerListener(c,false,b)},addOnce:function(c,b){return this._registerListener(c,true,b)},_removeByIndex:function(b){this._bindings[b]._destroy();this._bindings.splice(b,1)},remove:function(c){if(!a.isDef(c)){throw new Error("listener is a required param of remove().")}var b=this._indexOfListener(c);if(b!==-1){this._removeByIndex(b)}return c},removeAll:function(){var b=this._bindings.length;while(b--){this._removeByIndex(b)}},getNumListeners:function(){return this._bindings.length},disable:function(){this._isEnabled=false},enable:function(){this._isEnabled=true},isEnabled:function(){return this._isEnabled},halt:function(){this._shouldPropagate=false},dispatch:function(e){if(!this._isEnabled){return}var b=Array.prototype.slice.call(arguments),f=this._bindings.slice(),c=0,d;this._shouldPropagate=true;while(d=f[c++]){if(d.execute(b)===false||!this._shouldPropagate){break}}},dispose:function(){this.removeAll();delete this._bindings},toString:function(){return"[Signal isEnabled: "+this._isEnabled+" numListeners: "+this.getNumListeners()+"]"}};a.SignalBinding=function(e,b,d,c){this._listener=e;this._isOnce=b;this.context=d;this._signal=c};a.SignalBinding.prototype={_isEnabled:true,execute:function(b){var c;if(this._isEnabled){c=this._listener.apply(this.context,b);if(this._isOnce){this.detach()}}return c},detach:function(){return this._signal.remove(this._listener)},getListener:function(){return this._listener},dispose:function(){this.detach();this._destroy()},_destroy:function(){delete this._signal;delete this._isOnce;delete this._listener;delete this.context},disable:function(){this._isEnabled=false},enable:function(){this._isEnabled=true},isEnabled:function(){return this._isEnabled},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce: "+this._isOnce+", isEnabled: "+this._isEnabled+"]"}}}());