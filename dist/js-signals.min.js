/*!
 * JS Signals <https://github.com/millermedeiros/js-signals>
 * Released under the MIT license (http://www.opensource.org/licenses/mit-license.php)
 * @author Miller Medeiros <http://millermedeiros.com>
 * @version 0.5
 * @build 112 01/29/2011 11:01 PM
 */
(function(c){var a=c.signals={};a.VERSION="0.5";a.Signal=function(){this._bindings=[]};a.Signal.prototype={_shouldPropagate:true,_isEnabled:true,_registerListener:function(g,f,e){if(g===void (0)){throw new Error("listener is a required param of add() and addOnce().")}var d=this._indexOfListener(g),h;if(d!==-1){h=this._bindings[d];if(h.isOnce()!==f){throw new Error("You cannot add"+(f?"":"Once")+"() then add"+(!f?"":"Once")+"() the same listener without removing the relationship first.")}}else{h=new b(g,f,e,this);this._addBinding(h)}return h},_addBinding:function(d){this._bindings.push(d)},_indexOfListener:function(d){var e=this._bindings.length;while(e--){if(this._bindings[e]._listener===d){return e}}return -1},add:function(e,d){return this._registerListener(e,false,d)},addOnce:function(e,d){return this._registerListener(e,true,d)},_removeByIndex:function(d){this._bindings[d]._destroy();this._bindings.splice(d,1)},remove:function(e){if(e===void (0)){throw new Error("listener is a required param of remove().")}var d=this._indexOfListener(e);if(d!==-1){this._removeByIndex(d)}return e},removeAll:function(){var d=this._bindings.length;while(d--){this._removeByIndex(d)}},getNumListeners:function(){return this._bindings.length},disable:function(){this._isEnabled=false},enable:function(){this._isEnabled=true},isEnabled:function(){return this._isEnabled},halt:function(){this._shouldPropagate=false},dispatch:function(g){if(!this._isEnabled){return}var d=Array.prototype.slice.call(arguments),h=this._bindings.slice(),e=0,f;this._shouldPropagate=true;while(f=h[e++]){if(f.execute(d)===false||!this._shouldPropagate){break}}},dispose:function(){this.removeAll();delete this._bindings},toString:function(){return"[Signal isEnabled: "+this._isEnabled+" numListeners: "+this.getNumListeners()+"]"}};function b(g,d,f,e){this._listener=g;this._isOnce=d;this.context=f;this._signal=e}b.prototype={_isEnabled:true,execute:function(d){var e;if(this._isEnabled){e=this._listener.apply(this.context,d);if(this._isOnce){this.detach()}}return e},detach:function(){return this._signal.remove(this._listener)},getListener:function(){return this._listener},dispose:function(){this.detach();this._destroy()},_destroy:function(){delete this._signal;delete this._isOnce;delete this._listener;delete this.context},disable:function(){this._isEnabled=false},enable:function(){this._isEnabled=true},isEnabled:function(){return this._isEnabled},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce: "+this._isOnce+", isEnabled: "+this._isEnabled+"]"}}}(this));