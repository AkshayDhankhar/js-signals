/*
 * JS Signals <https://github.com/millermedeiros/js-signals>
 * Released under the MIT license (http://www.opensource.org/licenses/mit-license.php)
 * @author Miller Medeiros <http://millermedeiros.com>
 * @version 0.2
 * @build 47 11/26/2010 07:20 PM
 */
(function(){var e=window.signals={};e.Signal=function(){this._bindings=[]};e.Signal.prototype={_shouldPropagate:true,_isPaused:false,_registerListener:function f(u,t,s){var r=this._indexOfListener(u),v;if(r!==-1){v=this._bindings[r];if(v.isOnce()!==t){throw new Error("You cannot "+(t?"add()":"addOnce()")+" then "+(!t?"add()":"addOnce()")+" the same listener without removing the relationship first.")}}else{v=new e.SignalBinding(u,t,s,this);this._bindings.push(v)}return v},_indexOfListener:function a(r){var s=this._bindings.length;while(s--){if(this._bindings[s].listener===r){return s}}return -1},add:function p(s,r){return this._registerListener(s,false,r)},addOnce:function b(s,r){return this._registerListener(s,true,r)},remove:function g(s){var r=this._indexOfListener(s);if(r!==-1){this._bindings.splice(r,1)}return s},removeAll:function j(){this._bindings.length=0},getNumListeners:function n(){return this._bindings.length},pause:function q(){this._isPaused=true},resume:function d(){this._isPaused=false},isPaused:function h(){return this._isPaused},stopPropagation:function m(){this._shouldPropagate=false},dispatch:function i(u){if(this._isPaused){return}var r=Array.prototype.slice.call(arguments),v=this._bindings.slice(),s=0,t;while(t=v[s++]){if(t.execute(r)===false||!this._shouldPropagate){break}}this._shouldPropagate=true},toString:function c(){return"[Signal isPaused: "+this._isPaused+" numListeners: "+this.getNumListeners()+"]"}};e.SignalBinding=function o(u,s,r,t){this.listener=u;this._isOnce=s;this.listenerScope=r;this._signal=t};e.SignalBinding.prototype={_isPaused:false,execute:function l(r){if(!this._isPaused){if(this._isOnce){this._signal.remove(this.listener)}return this.listener.apply(this.listenerScope,r)}},pause:function q(){this._isPaused=true},resume:function d(){this._isPaused=false},isPaused:function h(){return this._isPaused},isOnce:function k(){return this._isOnce},toString:function c(){return"[SignalBinding listener: "+this.listener+", isOnce: "+this._isOnce+", isPaused: "+this._isPaused+", listenerScope: "+this.listenerScope+"]"}}}());