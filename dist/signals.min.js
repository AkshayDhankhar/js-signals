/*

 JS Signals <http://millermedeiros.github.com/js-signals/>
 Released under the MIT license
 Author: Miller Medeiros
 Version: 0.7.4+ - Build: 256 (2012/03/07 06:02 PM)
*/
(function(h){function g(a,b,c,d,e){this._listener=b;this._isOnce=c;this.context=d;this._signal=a;this._priority=e||0}function f(a,b){if(typeof a!=="function")throw Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",b));}var d={VERSION:"0.7.4+"};g.prototype={active:!0,params:null,execute:function(a){var b;this.active&&this._listener&&(a=this.params?this.params.concat(a):a,b=this._listener.apply(this.context,a),this._isOnce&&this.detach());return b},detach:function(){return this.isBound()?
this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},getListener:function(){return this._listener},_destroy:function(){delete this._signal;delete this._listener;delete this.context},isOnce:function(){return this._isOnce},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}};d.Signal=function(){this._bindings=new d.LinkedList;this._prevParams=null};d.Signal.prototype={memorize:!1,
_shouldPropagate:!0,active:!0,_registerListener:function(a,b,c,d){var e=this._getBinding(a,c);if(e){if(e.isOnce()!==b)throw Error("You cannot add"+(b?"":"Once")+"() then add"+(!b?"":"Once")+"() the same listener without removing the relationship first.");}else e=new g(this,a,b,c,d),this._bindings.insert(e,this._sortedBindingInsert);this.memorize&&this._prevParams&&e.execute(this._prevParams);return e},_sortedBindingInsert:function(a,b){return a._priority<b._priority},has:function(a,b){return!!this._getBinding(a,
b)},_getBinding:function(a,b){var c;for(this._bindings.rewind();this._bindings.hasNext();)if(c=this._bindings.next(),c._listener===a&&c.context===b)return c;return null},add:function(a,b,c){f(a,"add");return this._registerListener(a,!1,b,c)},addOnce:function(a,b,c){f(a,"addOnce");return this._registerListener(a,!0,b,c)},remove:function(a,b){f(a,"remove");var c=this._getBinding(a,b);c&&(this._bindings.remove(c),c._destroy());return a},removeAll:function(){for(this._bindings.rewind();this._bindings.hasNext();)this._bindings.next()._destroy();
this._bindings.removeAll()},getNumListeners:function(){return this._bindings.size()},halt:function(){this._shouldPropagate=!1},dispatch:function(a){if(this.active){var b=Array.prototype.slice.call(arguments);if(this.memorize)this._prevParams=b;this._shouldPropagate=!0;for(this._bindings.rewind();this._bindings.hasNext()&&this._shouldPropagate;)if(this._bindings.next().execute(b)!==!1)break}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll();delete this._bindings;delete this._prevParams},
toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};typeof define==="function"&&define.amd?define(d):typeof module!=="undefined"&&module.exports?module.exports=d:h.signals=d})(this);